<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Messages - Coach Dashboard</title>
    <link rel="stylesheet" href="../assets/styles.css">
    <style>
        .messages-container {
            display: flex;
            gap: 20px;
            height: calc(100vh - 200px);
        }
        .conversations-list {
            flex: 1;
            background: white;
            border-radius: 8px;
            padding: 20px;
            overflow-y: auto;
        }
        .conversation-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background 0.2s;
        }
        .conversation-item:hover {
            background: #f8f9fa;
        }
        .conversation-item.active {
            background: #e3f2fd;
        }
        .message-thread {
            flex: 2;
            background: white;
            border-radius: 8px;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        .message-list {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
        }
        .message-item {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
        }
        .message-item.sent {
            background: #e3f2fd;
            margin-left: 50px;
        }
        .message-item.received {
            background: #f5f5f5;
            margin-right: 50px;
        }
        .message-input {
            display: flex;
            gap: 10px;
        }
        .message-input textarea {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: none;
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h2>TalantaScout</h2>
            <p class="user-role">Coach</p>
        </div>
        <nav class="sidebar-nav">
            <a href="dashboard.html"><i class="icon">üìä</i> Dashboard</a>
            <a href="teammanagement.html"><i class="icon">üë•</i> Team Management</a>
            <a href="trainingplans.html"><i class="icon">üèãÔ∏è</i> Training Plans</a>
            <a href="matchanalysis.html"><i class="icon">‚öΩ</i> Match Analysis</a>
            <a href="recruitmentpipeline.html"><i class="icon">üîç</i> Recruitment Pipeline</a>
            <a href="messages.html" class="active"><i class="icon">üí¨</i> Messages</a>
            <a href="profile.html"><i class="icon">üë§</i> Profile</a>
            <a href="../index.html"><i class="icon">üö™</i> Logout</a>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <header class="page-header">
            <h1>Messages</h1>
            <div class="header-actions">
                <button class="btn-primary" onclick="composeMessage()">+ New Message</button>
            </div>
        </header>

        <div class="messages-container">
            <!-- Conversations List -->
            <div class="conversations-list">
                <h3>Conversations</h3>
                <div id="conversationsList">
                    <!-- Conversations will be generated by JavaScript -->
                </div>
            </div>

            <!-- Message Thread -->
            <div class="message-thread">
                <h3 id="threadTitle">Select a conversation</h3>
                <div class="message-list" id="messageList">
                    <!-- Messages will be displayed here -->
                </div>
                <div class="message-input">
                    <textarea id="messageText" rows="3" placeholder="Type your message..."></textarea>
                    <button class="btn-primary" onclick="sendMessage()">Send</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample conversations data
        let conversations = [];
        let currentConversation = null;

        // Generate sample conversations
        function generateConversations() {
            const contacts = [
                { name: 'David Mwangi', role: 'Scout', unread: 2 },
                { name: 'Sarah Kimani', role: 'Team Manager', unread: 0 },
                { name: 'John Otieno', role: 'Player', unread: 1 },
                { name: 'Michael Ouma', role: 'Scout', unread: 0 },
                { name: 'Grace Wanjiru', role: 'Admin', unread: 3 },
                { name: 'Peter Kamau', role: 'Assistant Coach', unread: 0 },
                { name: 'James Wafula', role: 'Player', unread: 1 },
                { name: 'Mary Achieng', role: 'Physio', unread: 0 },
                { name: 'Patrick Kipchoge', role: 'Scout', unread: 0 },
                { name: 'Alice Nyambura', role: 'Admin', unread: 0 },
                { name: 'Robert Makokha', role: 'Player', unread: 2 },
                { name: 'Emma Chebet', role: 'Team Manager', unread: 0 },
                { name: 'Daniel Okoth', role: 'Scout', unread: 0 },
                { name: 'Lucy Njeri', role: 'Admin', unread: 1 },
                { name: 'Kevin Barasa', role: 'Player', unread: 0 },
                { name: 'Rose Wangari', role: 'Physio', unread: 0 },
                { name: 'Tom Mutua', role: 'Assistant Coach', unread: 0 },
                { name: 'Nancy Akinyi', role: 'Admin', unread: 0 },
                { name: 'George Odhiambo', role: 'Scout', unread: 1 },
                { name: 'Jane Muthoni', role: 'Team Manager', unread: 0 }
            ];

            contacts.forEach((contact, index) => {
                conversations.push({
                    id: index + 1,
                    name: contact.name,
                    role: contact.role,
                    lastMessage: 'Last message preview...',
                    timestamp: 'Today',
                    unread: contact.unread,
                    messages: [
                        {
                            text: `Hello, this is a message from ${contact.name}.`,
                            sender: 'them',
                            time: '10:30 AM'
                        },
                        {
                            text: 'Thank you for reaching out!',
                            sender: 'me',
                            time: '10:35 AM'
                        }
                    ]
                });
            });
        }

        // Render conversations list
        function renderConversations() {
            const container = document.getElementById('conversationsList');
            container.innerHTML = '';

            conversations.forEach(conv => {
                const unreadBadge = conv.unread > 0 ? `<span class="badge badge-danger">${conv.unread}</span>` : '';
                const item = document.createElement('div');
                item.className = 'conversation-item' + (currentConversation && currentConversation.id === conv.id ? ' active' : '');
                item.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>${conv.name}</strong> ${unreadBadge}
                            <div style="font-size: 12px; color: #666;">${conv.role}</div>
                            <div style="font-size: 12px; color: #999;">${conv.lastMessage}</div>
                        </div>
                        <div style="font-size: 11px; color: #999;">${conv.timestamp}</div>
                    </div>
                `;
                item.onclick = () => openConversation(conv.id);
                container.appendChild(item);
            });
        }

        // Open conversation
        function openConversation(id) {
            currentConversation = conversations.find(c => c.id === id);
            currentConversation.unread = 0;
            document.getElementById('threadTitle').textContent = `${currentConversation.name} (${currentConversation.role})`;
            
            renderMessages();
            renderConversations();
        }

        // Render messages
        function renderMessages() {
            const container = document.getElementById('messageList');
            container.innerHTML = '';

            if (!currentConversation) {
                container.innerHTML = '<p style="text-align: center; color: #999;">Select a conversation to start messaging</p>';
                return;
            }

            currentConversation.messages.forEach(msg => {
                const msgDiv = document.createElement('div');
                msgDiv.className = `message-item ${msg.sender === 'me' ? 'sent' : 'received'}`;
                msgDiv.innerHTML = `
                    <div>${msg.text}</div>
                    <div style="font-size: 11px; color: #999; margin-top: 5px;">${msg.time}</div>
                `;
                container.appendChild(msgDiv);
            });

            container.scrollTop = container.scrollHeight;
        }

        // Send message
        function sendMessage() {
            const textarea = document.getElementById('messageText');
            const text = textarea.value.trim();

            if (!text || !currentConversation) {
                alert('Please select a conversation and enter a message.');
                return;
            }

            const now = new Date();
            const time = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });

            currentConversation.messages.push({
                text: text,
                sender: 'me',
                time: time
            });

            currentConversation.lastMessage = text;
            currentConversation.timestamp = 'Just now';

            textarea.value = '';
            renderMessages();
            renderConversations();
        }

        // Compose new message
        function composeMessage() {
            alert('Compose New Message\n\nThis would open a dialog to start a new conversation.');
        }

        // Initialize
        generateConversations();
        renderConversations();
        renderMessages();
    </script>
</body>
</html>
